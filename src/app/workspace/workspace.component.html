<div class="container-fluid g-0">

    <navbar [path]="geUrl()"></navbar>

    <div class="row p-2 g-0 gap-1">
        <div class="row g-0 gap-1">
            <div class="col-auto">
                <div class="badge bg-secondary" (click)="showNotification('default', 'Click en opciones')">Opciones</div>
            </div>
        </div>
        <div class="col-auto d-grid" *ngIf="geUrl().includes('?path=')">
            <button class="btn btn-sm btn-outline-secondary shadow-sm" (click)=goBack()>Volver<i class="bi bi-arrow-left-short ms-1"></i></button>
        </div>
        <div class="col-auto d-grid">
            <button class="btn btn-sm btn-outline-secondary shadow-sm" (click)="getContent(geUrl())">Actualizar<i class="bi bi-arrow-clockwise ms-1"></i></button>
        </div>
        <div class="col-auto d-grid">
            <button class="btn btn-sm btn-outline-secondary shadow-sm">Ver ultimas versiones<i class="bi bi-eye-fill ms-1"></i></button>
        </div>
    </div>

    <div *ngIf="content" class="container-fluid">
        <div *ngIf="content.folders && content.folders.length > 0">
            <folders [folders]="content.folders" (folderEvent)="folderEvent($event)"></folders>
        </div>
        <div *ngIf="content.files && content.files.length > 0">
            <files [files]="content.files" [path]="geUrl()" (fileEvent)="fileEvent($event)"></files>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row g-0 gap-1 p-2">
            <label class="col d-grid" for="file">
                <div class="btn btn-sm btn-danger">
                    Selecciona un archivo
                </div>
                <input #fileInputField type="file" name="file" id="file" class="visually-hidden" (change)="checkExistence()">
            </label>
            <div *ngIf="fileInfo.exists" [@slideInRight] class="col-auto">
                <button type="button" class="btn btn-sm btn-danger px-4" data-bs-toggle="modal" data-bs-target="#uploadNameChange"><i class="bi bi-cloud-arrow-up-fill"></i></button>
            </div>
        </div>
        <div *ngIf="fileInfo.exists" [@slideInLeft] class="d-flex g-0 gap-1 px-2">
            <span class="badge bg-danger">{{fileInfo.name}}</span>
            <span class="badge bg-danger">{{fileInfo.size}}</span>
            <span class="badge bg-danger">{{fileInfo.extension}}</span>
        </div>
    </div>

    <div>
        <h4>Crear carpeta</h4>
        <div>
            <input type="text" name="directoryName" id="directoryName">
            <button type="button" class="is-danger" (click)="makeDirectory($event)">Crear carpeta</button>
        </div>
    </div>

    <div *ngIf="selected" class="modal fade bg-opacity-75 bg-light" id="confirmationDelete" tabindex="-1" aria-labelledby="confirmationDeleteLabel" aria-hidden="true">
        <div class="modal-dialog mt-5">
            <div *ngIf="selected.isFile; then isFile; else isFolder"></div>
            <ng-template #isFile>
                <div class="modal-content">
                    <div class="modal-header bg-danger border-0">
                        <h5 class="modal-title text-light" id="confirmationDeleteLabel">¿Deseas eliminar este archivo?</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center">
                        <p class="m-0">Vas a eliminar el archivo:</p>
                        <span *ngIf="selected.element" class="badge bg-light text-danger">{{selected.element}}</span>
                        <div class="row gap-2 mt-3 mx-2">
                            <button type="button" class="col d-grid btn btn-sm btn-danger" (click)="deleteFile(selected.element)">Eliminar</button>
                            <button type="button" class="col d-grid btn btn-sm btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        </div>
                    </div>
                </div>
            </ng-template>
            <ng-template #isFolder>
                <div class="modal-content">
                    <div class="modal-header bg-danger border-0">
                        <h5 class="modal-title text-light" id="confirmationDeleteLabel">¿Deseas eliminar esta carpeta?</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center">
                        <p class="m-0">Vas a eliminar la carpeta:</p>
                        <span *ngIf="selected.element" class="badge bg-light text-danger">{{selected.element}}</span>
                        <div class="row gap-2 mt-3 mx-2">
                            <button type="button" class="col d-grid btn btn-sm btn-danger" (click)="deleteFolder(selected.element)">Eliminar</button>
                            <button type="button" class="col d-grid btn btn-sm btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        </div>
                    </div>
                </div>
            </ng-template>
        </div>
    </div>
    
    <div class="modal fade bg-opacity-75 bg-light" id="uploadNameChange" tabindex="-1" aria-labelledby="uploadNameChangeLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger border-0">
                    <h5 class="modal-title text-light" id="uploadNameChangeLabel">Subida de archivo</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <p class="text-danger"><i class="bi bi-info-square-fill me-2"></i>Puedes cambiar el nombre del archivo y añadirle una versión.</p>
                        <div *ngIf="fileInfo.exists" [@slideInLeft] class="d-flex gap-1 justify-content-center">
                            <span class="badge bg-danger">{{fileInfo.name}}</span>
                            <span class="badge bg-danger">{{fileInfo.size}}</span>
                        </div>
                        <div class="d-grid mx-1 mt-2">
                            <div class="form-check form-switch">
                                <input #editNewNameCheckBox (change)="toggleCheckBoxName()" class="form-check-input" type="checkbox" role="switch">
                                <label class="form-check-label" for="editNewNameCheckBox">Editar nombre</label>
                            </div>
                        </div>
                        <div class="d-grid mt-2 mx-1">
                            <div *ngIf="checkBoxName; then checkBoxNameIsTrue; else checkBoxNameIsFalse"></div>
                            <ng-template #checkBoxNameIsTrue>
                                <input type="text" class="form-control" #newName placeholder="{{fileInfo.name || 'Introduce el nombre'}}" aria-describedby="newName">
                            </ng-template>
                            <ng-template #checkBoxNameIsFalse>
                                <input type="text" class="form-control" #newName placeholder="{{fileInfo.name || 'Introduce el nombre'}}" aria-describedby="newName" disabled>
                            </ng-template>
                        </div>
                    </div>
                    <div class="row gap-2 mt-3 mx-1">
                        <button type="button" class="col d-grid btn btn-sm btn-danger" (click)="uploadFile()">Subir</button>
                        <button type="button" class="col d-grid btn btn-sm btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<notifier-container></notifier-container>

    